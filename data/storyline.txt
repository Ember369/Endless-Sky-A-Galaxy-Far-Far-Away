# Copyright (c) 2015 by Michael Zahniser
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE.  See the GNU General Public License for more details.

mission "Wormhole Investigation 1: Scientists"
	landing
	name "Wormhole Investigation"
	description "Wormhole Investigation."
	source "Skillet"
	destination "Colony"
	passengers 3
	blocked `You're about to take off towards Pathway, but you don't have enough bunks for the scientists.`

	to offer
		random < 99

	on offer
		conversation
			`On your way to the spaceport food court, you can't help but hear an immense racket from behind you.`
			choice
				`	(Investigate.)`
			`	An odd congregation of white-coated scientists have just shuffled down the ramp of a transport, awkwardly heaving their suitcases down the ramp with a look of disdain and dishevelment. There are three of them, all in the crisp scientist gowns that are typical of the scientists from Deep. As soon as they leave the ship, the transport immediately lifts off the ground and away from the spaceport.`
			`	After swearing profusely at the departing ship, the scientists heave their luggage towards the food court, in the same direction that you are heading. They stand bewildered, muttering amongst themselves.`
			choice
				`	(Head over to them and ask if you can help.)`
			`	The leader of the scientists is a somewhat absent-minded man with a nasty habit of peering at his surroundings when he talks, as if he were ruminating the origins of the Universe. He addresses himself and his colleagues as scientists from Deep, a specific branch that focuses on the phenomenon of wormholes and the possibility of travelling between galaxies.`
			`	"Almost ten years of research has led to this," he proclaims as he points towards their suitcases, "equipment capable of detecting minute differences in gravitational fields down to the yocto-newton/kilogram, which has allowed us not only to determine the positions of large gravitational wells caused by black holes and stars, but also wormholes. Now, of course we are familiar with the wormhole that connects human space to the Hai, but we theorised that a wormhole between entire galaxies would have a vastly different gravitational oscillation. So all we had to do was change the parameters of our devices to only display gravitational anomalies of a certain energy frequency or higher, and that should lead us to an intergalactic wormhole."`
			`	"We were just on our way to the system Pathway due to our devices' readings," he continues, "but the merchant who offered to take us all the way backed out on our deal and left us here. Apparently we were too talkative."`
			choice
				`	"I can't imagine why."`
					goto ignored
				`	"Your research sounds amazing."`
					goto amazing
			label ignored
			`	He ignores you, and continues on his rant.`
					goto shame
			label amazing
			`	"I know, right?."`
			label shame
			`	"And now we're stuck here, out in the middle of nowhere, only with sufficient credits for a return journey back to Deep."`
			`	"It's such a shame," he continues, "we were so close to finally getting a look at an actual wormhole between galaxies.`
			choice
				`	"I could probably give you a lift there."`
					goto lift
				`	"Wait, so you've never actually found anything remotely related to your project?"`
					goto quiet
			label quiet
			`	He is quiet for a moment.`
			`	After a short pause, he taps affectionately at his suitcase and murmurs to himself, "I guess you might be right."`
			choice
				`	"I could probably give you a lift there."`
					goto lift
			label lift
			`	His eyes light up in an instant, and he suddenly regains his original vigour.`
			`	"Really? You'd really take us there? Even though we can't pay you?"`
			choice
				`	"Yeah, why not."`
					goto declare
			label declare
			`	"Alright," he declares, "let's head to Pathway. It's somewhere near the Mintaka system."`
				accept

	on accept
		event "pathway discovered"

	on enter "Pathway"
		dialog `As you enter the system, a derelict spaceship appears on your radar. It appears to be disabled, and of a design that you're unfamiliar with. The scientist besides you is almost quivering with excitement, pointing towards it with glee. "Lets board it and investigate!"`

	on visit
		dialog `You've landed on <planet>, but you haven't boarded the derelict ship. Better depart and board it first.`

	npc board
		personality derelict mute
		government "Wreckage"
		system "Pathway"
		ship "CR90 Corvette (Pathway)"
		conversation
			`When you board the derelict ship, you find the ship completely deserted, but remarkably still in reasonable condition. It appears that there is no oxygen supply onboard, though the ship itself still remains pressurised. After donning an oxygen suit, you wander down the eery passage ways alongside the scientists, who have already made their way towards the bridge of the vessel.  As you reach the bridge, a horrific sight lies ahead of you. It appears that the entire crew has perished due to oxygen deprivation. You can see the corpses huddling in a corner of the ship near an access panel, perhaps a last attempt to reroute power towards the oxygen generators.`

	on complete
		conversation
			`The derelict spaceship that you've retrieved from the asteroid field is unlike any ship design that you have seen before.`
			`	After probing its hull and outfits, the scientists find themselves peering at a strange tetrahedron-like object that strangely reminds you of a Hai keystone.`
			`	"Amazing," a scientist declares.`


event "pathway discovered"
	system "Pathway"
		pos -367.082 -458.021
		link Mintaka
	system Mintaka
		link "Pathway"
		link Almaaz
		link Alnitak
		link Tortor
		link Gorvi

ship "CR90 Corvette" "CR90 Corvette (Pathway)"
	sprite "ship/cr90corvetteliberator"
	thumbnail "thumbnail/cr90corvetteliberator"
	attributes
		category "Light Warship"
		"cost" 24000000
		"shields" 35000
		"hull" 10000
		"required crew" 165
		"bunks" 400
		"mass" 2000
		"drag" 5
		"heat dissipation" .45
		"fuel capacity" 700
		"cargo space" 40
		"outfit space" 624
		"weapon capacity" 240
		"engine capacity" 210
		weapon
			"blast radius" 300
			"shield damage" 700
			"hull damage" 350
			"hit force" 800
	outfits
		"Turbolaser Turret (Red)" 4
		"Dual Turbolaser Turret (Red)" 2
		
		"T3 Corvette Power Converter"
		"T3 Corvette Shield Projector"
		"Small Radar Jammer"
		"Medium Coolant System" 3
		"Sith Wayfinder"
		
		"Corvette Sublight Engine (Pink)"
		"Heavy Hyperspace Motivator"
		
	engine -68 283
	engine -23 282
	engine 23 280
	engine 69 282
	turret 0 -161 "Dual Turbolaser Turret (Red)"
	turret 0 -161 "Dual Turbolaser Turret (Red)"
	turret -38 -110 "Turbolaser Turret (Red)"
	turret 41 -110 "Turbolaser Turret (Red)"
	turret -39 -74 "Turbolaser Turret (Red)"
	turret 40 -73 "Turbolaser Turret (Red)"
	fighter -65 72 under
	fighter 67 74 under
	fighter 0 73
	explode "tiny explosion" 20
	explode "small explosion" 45
	explode "medium explosion" 50
	explode "large explosion" 40
	"final explode" "final explosion large" 1
	description "CR90 corvette"